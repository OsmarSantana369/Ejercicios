\documentclass[12pt, fleqn]{article}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage[margin = 21mm]{geometry}
\usepackage[none]{hyphenat}
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{parskip}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{urwchancal}
\usepackage{tikz}
\usetikzlibrary{babel, arrows.meta, positioning, decorations.pathmorphing, backgrounds, fit, petri}

\usepackage[proportional,scaled=1]{erewhon}
\usepackage[erewhon,vvarbb,bigdelims]{newtxmath}
\usepackage[T1]{fontenc}
\renewcommand*\oldstylenums[1]{\textosf{#1}}

\expandafter\def\expandafter\normalsize\expandafter{%
    \setlength\abovedisplayskip{-9pt}%
    \setlength\belowdisplayskip{5pt}%
}

\newcommand{\V}[1]{\mathrm{V} \! \left( #1 \right)}
\newcommand{\F}[1]{\mathrm{F} \! \left( #1 \right)}
\newcommand{\tray}[2]{$ #1 #2 $ -- trayectoria}

\begin{document}
	\begin{center}
		{\huge \textsc{Teoría de Digráficas}}
	
		{\Large \textsc{Digráficas Acíclicas}}
	
		{\Large \textsc{Tarea 5}} \\
		Osmar Dominique Santana Reyes \\
		21 de Noviembre de 2024
	\end{center} \vspace{3mm}

	Resuelve con todo detalle cada uno de los siguientes ejercicios.

	\begin{enumerate}
		\setcounter{enumi}{41}
		\item ¿Cómo son todas las digráficas tales que cada vértice forma una base?
		
		\emph{Solución.}

		Sea $D$ una digráfica en la que cada uno de sus vértices forma una base.

		Afirmación. $D$ es fuerte.

		Sean $ u,v \in \V{D} $, ya que $ \lbrace u \rbrace $ es una base de $D$, se tiene que, para $v$, existe una \tray{v}{u} en $D$. De manera similar, $ \lbrace v \rbrace $ es una base de $D$ por lo que, para $u$, existe una \tray{u}{v} en $D$.

		Por lo tanto, $D$ es fuerte. 
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Da un ejemplo de una digráfica con exactamente 6 bases y 4 cobases, donde cada base y cada cobase tenga por lo menos dos vértices.
		
		\emph{Solución.}

		Sea $D$ la siguiente digráfica:

		\begin{minipage}[h]{0.41\linewidth}
			\begin{tikzpicture}
				[inner sep = 1.1mm, bend angle = 21, hacia/.style = {black, line width = 1pt, -{Stealth[length=3mm]}}, desde/.style = {black, line width = 1pt, {Stealth[length=3mm]}-}, vertice/.style = {circle, draw = black, inner color = white, outer color = gray, line width = 1pt}]
				%\draw[step = 10mm, gray, very thin] (0,0) grid (9,5);
				\node[vertice] (u1) at (0, 1.5) [label = below:$u_1$] {};
				\node[vertice] (u2) at (0, 3.5) [label = above:$u_2$] {};
				\node[vertice] (u3) at (1, 2.5) [label = below:$u_3$] {}
				edge [desde] (u1)
				edge [hacia, bend right] (u2)
				edge [desde, bend left] (u2);
				\node[vertice] (u4) at (1, 5) [label = left:$u_4$] {}
				edge [hacia] (u3);
				\node[vertice] (u5) at (2, 4) [label = below:$u_5$] {}
				edge[hacia, bend right] (u4)
				edge[desde, bend left] (u4);
				\node[vertice] (u6) at (3, 4) [label = above:$u_6$] {}
				edge[hacia] (u5);
				\node[vertice] (u7) at (4, 4) [label = above:$u_7$] {}
				edge[hacia] (u6);
				\node[vertice] (u8) at (6, 3) [label = below:$u_8$] {}
				edge[hacia] (u7);
				\node[vertice] (u9) at (4, 2) [label = right:$u_9$] {}
				edge[hacia] (u8);
				\node[vertice] (u10) at (5, 1) [label = below:$u_{10}$] {}
				edge[hacia] (u9);
				\node[vertice] (u11) at (3, 1) [label = below:$u_{11}$] {}
				edge[hacia] (u10)
				edge[hacia] (u7)
				edge[desde] (u6);
				\node[vertice] (u12) at (2, 1) [label = above:$u_{12}$] {}
				edge[desde] (u11);
				\node[vertice] (u13) at (1, 1) [label = above:$u_{13}$] {}
				edge[hacia] (u12);
				\node[vertice] (u14) at (1, 0) [label = left:$u_{14}$] {}
				edge[hacia, bend right] (u12)
				edge[desde, bend left] (u12);
			\end{tikzpicture}
		\end{minipage} \hfill \begin{minipage}[h]{0.57\linewidth}
			Por la Proposición 20, se sabe que los vértices de ingrado 0 pertenencen a cualquier base de una digráfica, por lo que $ u_1 $ y $ u_{13} $ están en cualquier base. Luego, por el Teorema 21, no puede haber trayectorias entre dos vértices de una base, por lo que $ u_2, u_3, u_{12} $ y $ u_{14} $ no pueden ser elementos de alguna base, dado que existen las trayectorias $ (u_1, u_3, u_2), \; (u_1, u_3), \; (u_{13}, u_{12}) \; $ y $ \; (u_{13}, u_{12}, u_{14}) $, respectivamente. De esta manera, sea $ B $ una base de $D$, se sabe que $ u_1, u_{13} \in B $, pero $ u_2, u_3, u_{12}, u_{14} \notin B $. 
		\end{minipage}

		Además, para $ u_4 $ no existe ninguna \tray{u_1}{u_4} ni una \tray{u_{13}}{u_4} en $D$, por lo que $ B $ tiene más elementos. Ya que la trayectoria $ T = (u_{11}, u_{10}, u_9, u_8, u_7, u_6, u_5, u_4) $ contiene a los demás vértices de $D$, se tiene que solo uno de estos vértices pertenece a $ B $, pues si más de uno perteneciera, entonces es posible hallar una trayectoria contenida en $T$ entre dos vértices de $ B $, lo cual sería a una contradicción al Teorema 21. 

		Ahora, $ u_4, u_5 \notin B $, ya que no es posible hallar una \tray{u_4}{u_6} ni una \tray{u_5}{u_6} en $D$. Pero si es posible hallar una \tray{u_i}{u_j} en $D$ para cada $ i = 6, \ldots, 11 $ y para cada $ j = 4, \ldots, 11 $. De esta forma, las siguientes son bases de $D$: 

		$ B_1 = \left\lbrace u_1, u_{6}, u_{13} \right\rbrace, B_2 = \left\lbrace u_1, u_{7}, u_{13} \right\rbrace, B_3 = \left\lbrace u_1, u_{8}, u_{13} \right\rbrace, B_4 = \left\lbrace u_1, u_{9}, u_{13} \right\rbrace, B_5 = \left\lbrace u_1, u_{10}, u_{13} \right\rbrace$ y $ B_6 = \left\lbrace u_1, u_{11}, u_{13} \right\rbrace $.

		Por otro lado, los vértices de ingrado cero y exgrado mayor a cero no pertenecen a ninguna cobase de $D$, puesto que no hay trayectorias que terminen en estos. Así, sea $ C $ una cobase de $D$, se tiene que $ u_1, u_{13} \notin C $

        Después, si $ u_4 $ o $ u_5 $ pertenecen a $C$, entonces $ u_i \notin C $, para cada $ i = 2, 3, 6, 7, \ldots, 11 $, pues \, $ u_j \leadsto u_i $, para cada $ j = 4, 5 $ y para cada $ i = 2, 3 $, además de que $ u_i \leadsto u_j $, para cada $ i = 6, 7, \ldots, 11 $ y para cada $ j = 4, 5 $. Sin embargo, para $ u_2 $, la única trayectoria que inicia en este vértice es $ (u_2, u_3) $, pero $ u_3 \notin C $, lo cual contradice que $C$ sea una cobase. De este modo, $ u_4, u_5 \notin C $.

        Luego, si $ u_i \in C $, para algún $ i = 6, \ldots, 11 $, entonces $ C = \lbrace u_i \rbrace $, puesto que $ u_i \leadsto u_j $, para cada $ i = 6, 7, \ldots, 11 $ y para cada $ j = 2, 3, 4, 5, 12, 14 $. Sin embargo, para $ u_5 $, no existe ninguna trayectoria que inicie en este vértice y termine en $ u_i $, para cada $ i = 6, \ldots, 11 $, lo cual contradice que $C$ sea una cobase. De este modo, $ u_i \notin C $, para todo $ i = 6, \ldots, 11 $.

		De esta forma, ya que para cada $ i = 1, 4, \ldots, 11 $ y para cada $ j = 2, 3 $, se da que $ u_i \leadsto u_j $ en $D$, además de que $ u_{13} \leadsto u_{12} $, $ u_{13} \leadsto u_{14} $ y $ (u_2, u_3), (u_3, u_2), (u_{12}, u_{14}), (u_{14}, u_{12}) \in \F{D} $, se tiene que las cobases de $D$ son:

		$ C_1 = \left\lbrace u_2, u_{12} \right\rbrace, C_2 = \left\lbrace u_2, u_{14} \right\rbrace, C_3 = \left\lbrace u_3, u_{12} \right\rbrace $ y $ C_4 = \left\lbrace u_3, u_{14} \right\rbrace $.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item ¿Cómo son todas las digráficas tales que el conjunto de todos los vértices es una base de $D$.
		
		\emph{Solución.}

		Sea $D$ una digráfica tal que $ \V{D} $ es una base de $D$.

		Afirmación. $ \V{D} $ es la única base de $D$ y $ \F{D} = \emptyset $.

		Como $ \V{D} $ es una base de $D$, se tiene que $ \V{D} $ es un conjunto minimal de $ \left( \mathcal{B}_D, \subseteq \right) $, pero todo elemento de este conjunto está contenido en $ \V{D} $, por lo que $ \mathcal{B}_D = \lbrace \V{D} \rbrace $. Así, $ \V{D} $ es la única base de $D$.

		Ahora, por el Teorema 21, no puede haber trayectorias entre dos vértices de una base. De este modo, dado que $ \V{D} $ es la única base de $D$, se obtiene que entre cualquier par de vértices de $D$ no hay trayectorias, en particular, no hay flechas. Por lo tanto, $ \F{D} = \emptyset $.
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Da un ejemplo de una digráfica tal que todas sus bases sean también cobases.
		
		\begin{minipage}[h]{0.62\linewidth}
			\setlength{\parskip}{3mm}
			\emph{Solución.}

			Sea $D$ la digráfica de la izquierda. Ya que

			$ C = \left( u_4, u_{10}, u_5, u_6, u_1, u_2, u_6, u_3, u_7, u_8, u_9, u_{10}, u_5, u_6, u_4 \right) $ 
			
			es un camino cerrado generador en $D$, se tiene que $D$ es fuerte. Así, para cada $ u \in \V{D} $, existe una \tray{u}{v} y una \tray{v}{u}, para todo $ v \in \V{D} $, pues $D$ es fuerte. De esta forma, por el Teorema 21, cualquier base y cobase de $D$ debe tener un solo elemento, más aún, cada vértice de $D$ forma una base y una cobase de $D$.
		\end{minipage} \hfill \begin{minipage}[h]{0.36\linewidth}
			\begin{tikzpicture}
				[inner sep = 1.1mm, bend angle = 21, hacia/.style = {black, line width = 1pt, -{Stealth[length=3mm]}}, desde/.style = {black, line width = 1pt, {Stealth[length=3mm]}-}, vertice/.style = {circle, draw = black, inner color = white, outer color = gray, line width = 1pt}]
				%\draw[step = 10mm, gray, very thin] (0,0) grid (9,5);
				\node[vertice] (u1) at (0, 0) [label = below:$u_1$] {};
				\node[vertice] (u2) at (0, 2) [label = above:$u_2$] {}
				edge [desde] (u1);
				\node[vertice] (u3) at (2, 3) [label = above:$u_3$] {};
				\node[vertice] (u4) at (3, 2) [label = left:$u_4$] {};
				\node[vertice] (u5) at (3, 0) [label = below:$u_5$] {};
				\node[vertice] (u6) at (2, 1) [label = below:$u_6$] {}
				edge [hacia] (u1)
				edge [hacia] (u3)
				edge [hacia] (u4)
				edge [desde] (u2)
				edge [desde] (u5);
				\node[vertice] (u7) at (5, 2) [label = above:$u_7$] {}
				edge [desde] (u3);
				\node[vertice] (u8) at (5, 0) [label = below:$u_8$] {}
				edge [desde] (u7);
				\node[vertice] (u9) at (4, 0) [label = below:$u_9$] {}
				edge [desde] (u8);
				\node[vertice] (u10) at (4, 1) [label = right:$u_{10}$] {}
				edge [hacia] (u5)
				edge [hacia] (u7)
				edge [desde] (u4)
				edge [desde] (u9);
			\end{tikzpicture}
		\end{minipage}
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item ¿Cómo son todas las digráficas tales que todas sus bases son cobases?
		
		\emph{Solución.}

		
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Dá un ejemplo de una digráfica tal que tenga una base que también sea un conúcleo.
		
		\emph{Solución.}

		Sea $D$ la siguiente digráfica:

		\begin{minipage}[h]{0.35\linewidth}
			\begin{tikzpicture}
				[inner sep = 1.1mm, bend angle = 21, hacia/.style = {black, line width = 1pt, -{Stealth[length=3mm]}}, desde/.style = {black, line width = 1pt, {Stealth[length=3mm]}-}, vertice/.style = {circle, draw = black, inner color = white, outer color = gray, line width = 1pt}]
				%\draw[step = 10mm, gray, very thin] (0,0) grid (9,5);
				\node[vertice] (u1) at (13.8, 2) [label = below:$u_1$] {};
				\node[vertice] (u2) at (15.5, 3) [label = right:$u_2$] {}
				edge[hacia] (u1);
				\node[vertice] (u3) at (17.3, 3) [label = below:$u_3$] {};
				\node[vertice] (u4) at (19, 2) [label = below:$u_4$] {}
				edge[desde] (u3);
				\node[vertice] (u5) at (16.4, 2) [label = below:$u_5$] {}
				edge[hacia] (u1)
				edge[desde] (u2)
				edge[desde] (u3)
				edge[desde] (u4);
				\node[vertice] (u6) at (16.4, 6.5) [label = above:$u_6$] {};
				\node[vertice] (u7) at (16.4, 4.5) [label = below:$u_7$] {}
				edge[hacia] (u6);
				\node[vertice] (u8) at (15.1, 4.2) [label = left:$u_8$] {}
				edge[hacia] (u6)
				edge[desde] (u7)
				edge[desde] (u1)
				edge[desde] (u2);
				\node[vertice] (u9) at (17.7, 4.2) [label = right:$u_9$] {}
				edge[hacia] (u4)
				edge[desde] (u3)
				edge[desde] (u6)
				edge[desde] (u7);
			\end{tikzpicture}
		\end{minipage} \hfill \begin{minipage}[h]{0.6\linewidth}
			\setlength{\parskip}{3mm}
			Afirmación. $ B = \left\lbrace u_2, u_3, u_7 \right\rbrace $ es una base y un conúcleo de $D$.

			Ya que $ u_2, u_3, u_7 $ son de ingrado 0, se tiene que no hay flechas ni trayectorias entre ellos, por lo que $ B $ es independiente y cumple el inciso $ (ii) $ del Teorema 21.

			Luego, dado que $ u_1, u_4, u_5, u_6, u_8, u_9 \notin B $ y $ \left\lbrace (u_2, u_1), \right. $ $ \left. (u_2, u_5), (u_2, u_8), (u_3, u_4), (u_3, u_9), (u_7, u_6) \right\rbrace \subseteq \F{D} $, se obtiene que $B$ es absorbente y para cada $ u_i \in \V{D} $, con $ i = 1, \ldots, 9 $, existe $ v \in B $ tal que $ v \leadsto u_i $, cumpliéndose el inciso $ (i) $ del Teorema 21.
		\end{minipage}

		Por todo lo anterior, $ B $ es tanto base como conúcleo de $D$.
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Decimos que una digráfica es transitiva si para cualesquiera tres vértices distintos $ u, v, w, $ tales que $ \left\lbrace (u, v), (v,w) \right\rbrace \subseteq \F{D} $ se tiene que $ (u,w) \in \F{D} $. Prueba que si $D$ es una digráfica transitiva entonces toda cobase de $D$ es un núcleo de $D$.
		
		\emph{Demostración.}

		Sea $ C $ una cobase de $D$, por el Teorema 21', no hay trayectorias entre los vértices que pertenecen a $C$, en particular, no hay flechas, lo cual implica que $C$ es un conjunto independiente de $D$. 

		Después, para cada $ u \in C $, sea $ \tau_u = \left\lbrace v \in \V{D} \setminus \{ u \} \, : \, v \leadsto u \right\rbrace $, que es no vacío, pues de lo contrario $ C \setminus \{ u \} $, donde $ \tau_u = \emptyset $, también sería una cobase de $D$, lo cual contradice la definición de cobase. Luego, sea $ u \in C $ y para cada $ v \in \tau_u $ sea $ T_v^u $ una \tray{v}{u}.

		Afirmación. $ (v, u) \in \F{D} $ para cada $ v \in \tau_u $.

		Sea $ v \in \tau_u $. Procediendo por inducción sobre $ n = l(T_v^u) $:

		Para $ n = 1 $: $ T_v^u = (v, u) $, por lo que $ (v, u) \in \F{D} $.

		Para $ n = 2 $: $ T_v^u = (v, x, u) $, con $ x \in \V{D} $, por lo que $ \left\lbrace (v, x), (x, u) \right\rbrace \subseteq \F{D} $. Así, $ (v, u) \in \F{D} $, pues $D$ es transitiva.

		Ahora, suponiendo que para \, $ n = k $ \, se cumple la afirmación. Si \, $ n = k+1 $ \, entonces $ T_v^u = (v = x_0, x_1, \ldots, x_{k+1} = u) $. Sea $ t_v^u = (x_1, \ldots, x_{k+1} = u) $, como $ l(t_v^u) = k $ y $ x_1 \in \tau_u $, por hipótesis de inducción, se obtiene que $ (x_1, u) \in \F{D} $. De esta manera, $ (v, u) \in \F{D} $, pues $ \left\lbrace (v, x_1), (x_1, u) \right\rbrace \subseteq \F{D} $ y $D$ es transitiva.

		Por lo tanto, $ (v, u) \in \F{D} $ para cada $ v \in \tau_u $, y como $ u $ fue arbitrario, lo anterior se cumple para todo $ u \in C $. Así, para cada $ v \in \V{D} \setminus C $, existe $ u \in C $ tal que $ (v, u) \in \F{D} $, dado que $C$ es una cobase, por lo cual $C$ es absorbente. 

		En conclusión, toda cobase de $D$ es un núcleo de $D$, pues $C$ fue arbitrario.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Prueba que si $D$ es una digráfica tal que toda cobase de $D$ es un núcleo entonces $D$ es transitiva.
		
		\emph{Demostración.}

		Suponiendo que el orden de $D$ es mayor o igual que 3. Sean $ u, v, w \in \V{D} $ tales que $ \left\lbrace (u, v), (v, w) \right\rbrace \subseteq \F{D} $ y $C$ alguna cobase de $D$, ya que no puede haber trayectorias entre vértices de $C$, se tiene lo siguiente:

		\begin{itemize}
			\item $ u, v, w $ no pueden pertenecer a $C$ simultáneamente.
			\item No puede ser que $ u, v \in C $, $ v, w \in C $ ni $ u, w \in C $ de manera simultánea.
			\item Si $ u \in C $ entonces 
		\end{itemize}
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Para cada $ p \geq 3 $, dá un ejemplo de una digráfica semicompleta con $n$ vértices que no tenga núcleo.
		
		\emph{Solución.}

		
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Sea $D$ una digráfica transitiva, demuestra que $D$ tiene núcleo.
		
		\emph{Demostración.}

		
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
		\item Decimos que una digráfica es núcleo imperfecta crítica si no tiene núcleo pero toda subdigráfica inducida sí tiene núcleo. Prueba que un ciclo dirigido de longitud impar es núcleo imperfecta crítica.
		
		\emph{Demostración.}

		
		
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	\end{enumerate}
\end{document}
