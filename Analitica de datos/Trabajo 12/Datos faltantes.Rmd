---
title: "DATOS FALTANTES"
author: "Osmar Dominique"
date: "2025-09-24"
output: html_document
---

## DATOS FALTANTES Y ATÍPICOS


Antes de realizar una análisis estadístico, debemos considerar si tenemos la presencia de datos faltantes y/o datos atípicos que puedan dar conclusiones sesgadas de todo el análisis. 

## DATOS FALTANTES

Primero identificamos si existen datos faltantes (ya sea en una variable o en varias variables). Si existen podemos realizar:

* Eliminar la observación completa y solo quedarnos con los datos completos. 

* Reemplazar los datos faltantes con otro valor (media y mediana)


### EJEMPLO: 
Vamos a generar un data frame con dos variables y cinco observaciones que incluyan dos datos faltantes. 

```{r}
ejemplo<-data.frame(x=c(3,5,2,NA,1),y=c(4,NA,9,2,3))
ejemplo
```
```{r}
library(dplyr)
library(tidyverse)
```

```{r}
#is.na usamos para mostrar los datos faltantes
sum(is.na(ejemplo))

```

* Primero elimenemos las observaciones con datos faltantes (Esto solo conviene si se tienen pocas observaciones faltantes, ya que de lo contrario, podemos eliminar información valiosa para el análisis).

```{r}
ejemplo %>% drop_na()  #Elimina toda la observación que tenga al menos un dato faltante
```

* Reemplazar por la media (o la mediana) de cada variable los datos faltantes

```{r}
ejemplo %>% replace_na(list(x=5,y=1)) #reemplazamos con valores dados
```
```{r}
ejemplo %>% replace_na(as.list(colMeans(.,na.rm=TRUE)))
```
## EJEMPLO PIB

Vamos a analizar el PIB de los países del año 2022, que nos indica el desempñeo económico de los países en el año 2022 en dólares. 

```{r}
PIB<-read.csv("C:/Users/Alumno 25-B/Documents/Osmar/Analítica/Trabajo 12/PIB.csv")
head(PIB)
```

Vamos a extrear la columna X2022 (2019 variable propia)

```{r}
datos22<-PIB$X2022
head(datos22)
```

Verificamos si existen datos faltantes

```{r}
sum(is.na(datos22))
```

*Primero reemplacemos los datos faltantes con la media

```{r}
datos22[is.na(datos22)]<-0 #los valores faltantes los convertimos a cero
datos22_0<-datos22   #guardamos este data frame con valores faltantes en 0.  
media<-mean(datos22)
datos22media<-replace(datos22, datos22_0==0, media)   # Los datos que tienen 0 se reemplazarán con la media y se guarda en datos22
head(datos22media)
```

Antes de realizar un análisis descriptivo de la variable, observemos cómo es el comportamiento de los datos atípicos mediante un boxplot. 

```{r}
boxplot(datos22media, horizontal=TRUE,main="Boxplot media con datos atípicos")
stripchart(datos22media,method="jitter",pch=16, add=TRUE, col="magenta") #agregamos los datos
```
Al observar, tenemos datos atípicos que se alejan demasiado de los extremos de los alambres, por lo que antes de realizar el análisis descriptivo llevaremos los puntos atípicos a los extremos de los almabres. 

Recordemos que estos extemos se calculan mediante
$$Extremoizquierdo=Q_1 -1.5*IQR$$
$$Extremoderecho=Q_3+1.5*IQR$$
donde 
$$IQR=Q_3-Q_1$$
Calculemos estos extremos para nuestra variable
```{r}
summary(datos22media)
```
```{r}
extizq<-2462.6-1.5*(21260-2462.6)  #guardamos los valores de los dos extremos
extder<-2462.6+1.5*(21260-2462.6)
```

Ahora vamos a sustituir los valores atípicos por estos extremos

```{r}
datosnoatipicos<-datos22media[datos22media>extizq & datos22media<=extder] #nos quedamos con los valores dentro de los alambres
valor<-max(datosnoatipicos)   #guardar el dato máximo de los datos no atípicos
datos22media[datos22media>extder]<-valor #modificamos los datos atípicos del extremo derecho
```

Volvemos a visualizar el boxplot para verificar como quedaron los datos atípicos

```{r}
boxplot(datos22media, horizontal=TRUE,main="Boxplot media con datos atípicos")
stripchart(datos22media,method="jitter",pch=16, add=TRUE, col="magenta") #agregamos los datos

```

Con estos valores, obtengamos los estadísticos descriptivos y un histograma para poder analizarlos.

```{r}
summary(datos22media)
```

* HISTOGRAMA CON DATOS FALTANTES SUSTITUIDOS POR LA MEDIA Y LOS ATÍPICOS REEEMPLAZADOS POR EL EXTREMO DERECHO. 

```{r}
histo<-hist(datos22media,
     xlab="PIB",
     ylab="Frecuencia",
     col="blue",
     border="black",
     ylim=c(0,100))
text(histo$mids, histo$counts,labels=histo$counts, pos=3)
```




*Reemplacemos los datos faltantes con la mediana

```{r}
mediana<-median(datos22)
datos22mediana<-replace(datos22, datos22_0==0, mediana)
head(datos22mediana)

```


Antes de realizar un análisis descriptivo de la variable, observemos como es el comportamiento de los datos atípicos mediante un boxplot. 

```{r}
boxplot(datos22mediana, horizontal=TRUE,main="Boxplot mediana con datos atípicos")
stripchart(datos22mediana,method="jitter",pch=16, add=TRUE, col="magenta") #agregamos los datos
```
Al observar, tenemos datos atípicos que se alejan demasiado de los extremos de los alambres, por lo que antes de realizar el análisis descriptivo llevaremos los puntos atípicos a los extremos de los almabres. 

Recordemos que estos extemos se calculan mediante
$$Extremoizquierdo=Q_1 -1.5*IQR$$
$$Extremoderecho=Q_3+1.5*IQR$$
donde 
$$IQR=Q_3-Q_1$$
Calculemos estos extremos para nuestra variable
```{r}
summary(datos22mediana)
```
```{r}
extizq<-2462.6-1.5*(21260-2462.6)  #guardamos los valores de los dos extremos
extder<-2462.6+1.5*(21260-2462.6)
```

Ahora vamos a sustituir los valores atípicos por estos extremos

```{r}
datosnoatipicos<-datos22mediana[datos22mediana>extizq & datos22mediana<=extder] #nos quedamos con los valores dentro de los alambres
valor<-max(datosnoatipicos)   #guardar el dato máximo de los datos no atípicos
datos22mediana[datos22mediana>extder]<-valor #modificamos los datos atípicos del extremo derecho
```

Volvemos a visualizar el boxplot para verificar como quedaron los datos atípicos

```{r}
boxplot(datos22mediana, horizontal=TRUE,main="Boxplot media con datos atípicos")
stripchart(datos22mediana,method="jitter",pch=16, add=TRUE, col="magenta") #agregamos los datos

```

Con estos valores, obtengamos los estadísticos descriptivos y un histograma para poder analizarlos.

```{r}
summary(datos22mediana)
```

* HISTOGRAMA CON DATOS FALTANTES SUSTITUIDOS POR LA MEDIA Y LOS ATÍPICOS REEEMPLAZADOS POR EL EXTREMO DERECHO. 

```{r}
histo<-hist(datos22mediana,
     xlab="PIB",
     ylab="Frecuencia",
     col="blue",
     border="black",
     ylim=c(0,100))
text(histo$mids, histo$counts,labels=histo$counts, pos=3)
```

Al momento de analizarlo con la media y la mediana, para poder realizar el análisis descriptivo final nos podríamos quedar con el de la mediana. 

# Ejercicio: De los dos años que se eligieron, realizar lo siguiente:

0. Cambiar los datos faltantes para una variable por la media y la otra variable por la mediana. Y los datos atípicos cambiarlos por los máximo y mínimo de los alambres (bigotes).

1. Un análisis descriptivo de las dos variables (media, mediana, moda, varianza, desviación estándar, CV, cuántiles)

2. Colocar al menos dos gráficos por cada variable. Dar una pequeña interpretación.

3. Realizar una regresión lineal simple de los dos años. Prdecir el PIB del año posterior a partir del año anterior. Encontrar el modelo, y decir si es bueno para realizar predicciones (mostrar dos predicciones para dos valores de PIB).

Fecha de entrega: 2 de octubre 11:59 p.m.

